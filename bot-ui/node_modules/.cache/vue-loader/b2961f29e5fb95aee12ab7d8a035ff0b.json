{"remainingRequest":"C:\\soft\\workspace\\bot-manager\\bot-ui\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\soft\\workspace\\bot-manager\\bot-ui\\src\\views\\Core\\ExportExcel.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\soft\\workspace\\bot-manager\\bot-ui\\src\\views\\Core\\ExportExcel.vue","mtime":1702475008424},{"path":"C:\\soft\\workspace\\bot-manager\\bot-ui\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\soft\\workspace\\bot-manager\\bot-ui\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"C:\\soft\\workspace\\bot-manager\\bot-ui\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\soft\\workspace\\bot-manager\\bot-ui\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQppbXBvcnQgRmlsZVNhdmVyIGZyb20gJ2ZpbGUtc2F2ZXInDQppbXBvcnQgWExTWCBmcm9tICd4bHN4Jw0KZXhwb3J0IGRlZmF1bHQgew0KbmFtZTogIkV4cG9ydEV4Y2VsIiwNCnByb3BzOiB7DQogIGluZm86IHsNCiAgICB0eXBlOiBPYmplY3QsDQogICAgZGVmYXVsdDoge30NCiAgfSwNCiAgY29sdW1uczogew0KICAgIHR5cGU6IEFycmF5LA0KICAgIGRlZmF1bHQ6IFtdDQogIH0sDQogIHRhYmxlRGF0YTogew0KICAgIHR5cGU6IEFycmF5LA0KICAgIGRlZmF1bHQ6IFtdDQogIH0NCn0sDQogIG1ldGhvZHM6ew0KICAgIC8vZXhjZWzlr7zlh7oNCiAgICBleHBvcnRFeGNlbCAoKSB7DQogICAgICB2YXIgeGxzeFBhcmFtID0geyByYXc6IHRydWUgfSAvLyDlr7zlh7rnmoTlhoXlrrnlj6rlgZrop6PmnpDvvIzkuI3ov5vooYzmoLzlvI/ovazmjaINCiAgICAgIHZhciB3YiA9IFhMU1gudXRpbHMudGFibGVfdG9fYm9vayhkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjJyt0aGlzLmluZm8uaWQpLHhsc3hQYXJhbSkNCiAgICAgIHZhciB3Ym91dCA9IFhMU1gud3JpdGUod2IsIHsgYm9va1R5cGU6ICd4bHN4JywgYm9va1NTVDogdHJ1ZSwgdHlwZTogJ2FycmF5JyB9KQ0KICAgICAgdHJ5IHsNCiAgICAgICAgRmlsZVNhdmVyLnNhdmVBcyhuZXcgQmxvYihbd2JvdXRdLCB7IHR5cGU6ICdhcHBsaWNhdGlvbi9vY3RldC1zdHJlYW0nIH0pLCB0aGlzLmluZm8ubmFtZSkNCiAgICAgIH0gY2F0Y2ggKGUpIHsNCiAgICAgICAgaWYgKHR5cGVvZiBjb25zb2xlICE9PSAndW5kZWZpbmVkJykgY29uc29sZS5sb2coZSwgd2JvdXQpDQogICAgICB9DQogICAgICByZXR1cm4gd2JvdXQNCiAgICB9LA0KICB9DQp9DQo="},{"version":3,"sources":["ExportExcel.vue"],"names":[],"mappings":";;;;;;;;;;;AAWA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"ExportExcel.vue","sourceRoot":"src/views/Core","sourcesContent":["<template>\r\n  <div v-show='false'>\r\n    <el-table :data=\"tableData\" :id=\"info.id\">\r\n      <el-table-column v-for=\"column in columns\"\r\n          :type=\"column.type\" :prop=\"column.prop\" :label=\"column.label\"  :key=\"column.prop\"  :formatter=\"column.formatter\">\r\n      </el-table-column>\r\n    </el-table>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport FileSaver from 'file-saver'\r\nimport XLSX from 'xlsx'\r\nexport default {\r\nname: \"ExportExcel\",\r\nprops: {\r\n  info: {\r\n    type: Object,\r\n    default: {}\r\n  },\r\n  columns: {\r\n    type: Array,\r\n    default: []\r\n  },\r\n  tableData: {\r\n    type: Array,\r\n    default: []\r\n  }\r\n},\r\n  methods:{\r\n    //excel导出\r\n    exportExcel () {\r\n      var xlsxParam = { raw: true } // 导出的内容只做解析，不进行格式转换\r\n      var wb = XLSX.utils.table_to_book(document.querySelector('#'+this.info.id),xlsxParam)\r\n      var wbout = XLSX.write(wb, { bookType: 'xlsx', bookSST: true, type: 'array' })\r\n      try {\r\n        FileSaver.saveAs(new Blob([wbout], { type: 'application/octet-stream' }), this.info.name)\r\n      } catch (e) {\r\n        if (typeof console !== 'undefined') console.log(e, wbout)\r\n      }\r\n      return wbout\r\n    },\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n\r\n</style>\r\n"]}]}